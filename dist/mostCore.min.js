!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.mostCore=t.mostCore||{})}(this,function(t){"use strict";function e(t,e){if(t<0)throw new TypeError("n must be >= 0");var i=e.length;return 0===t||0===i?e:t>=i?[]:n(t,e,i-t)}function n(t,e,n){for(var i=new Array(n),r=0;r<n;++r)i[r]=e[t+r];return i}function i(t){return e(1,t)}function r(t){for(var e=t.length,n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function o(t,e){for(var n=e.length,i=new Array(n),r=0;r<n;++r)i[r]=t(e[r]);return i}function s(t,e,n){for(var i=e,r=0,o=n.length;r<o;++r)i=t(i,n[r],r);return i}function u(t,e){for(var n=e.length,i=new Array(n),r=0,o=void 0,s=0;s<n;++s)o=e[s],t(o)||(i[r]=o,++r);return i.length=r,i}function h(t,e){for(var n=0,i=e.length;n<i;++n)if(t===e[n])return n;return-1}function c(t){return null!=t&&"number"==typeof t.length&&"function"!=typeof t}function p(t){function e(n,i){switch(arguments.length){case 0:return e;case 1:return function(e){return t(n,e)};default:return t(n,i)}}return e}function f(t){function e(n,i,r){switch(arguments.length){case 0:return e;case 1:return p(function(e,i){return t(n,e,i)});case 2:return function(e){return t(n,i,e)};default:return t(n,i,r)}}return e}function a(t){this.source=t}function d(t,e){this._dispose=t,this._data=e}function v(){this.disposable=void 0,this.disposed=!1,this._resolve=void 0;var t=this;this.result=new Promise(function(e){t._resolve=e})}function l(t){return null!==t&&"object"==typeof t&&"function"==typeof t.then}function y(t,e,n){var i=g(e);return l(i)?i.catch(function(e){n.error(t,e)}):i}function w(t,e){return x(new d(t,e))}function k(){return new d(mi,void 0)}function m(t){return w(_,t)}function _(t){return Promise.all(ki(g,t))}function g(t){try{return t.dispose()}catch(t){return Promise.reject(t)}}function b(){return new v}function x(t){return new d(A,E(t))}function A(t){return t.disposed||(t.disposed=!0,t.value=g(t.disposable),t.disposable=void 0),t.value}function E(t){return{disposed:!1,disposable:t,value:void 0}}function P(t){setTimeout(function(){throw t},0)}function T(t,e,n){this._run=t,this.value=e,this.sink=n,this.active=!0}function I(t,e,n){n.error(t,e)}function C(t,e,n){n.event(t,e)}function M(t,e,n){n.end(t,e)}function L(t){return new a(new R(t))}function R(t){this.value=t}function q(t,e,n){n.event(t,e),n.end(t,void 0)}function N(){return _i}function B(){}function S(t){return t.dispose()}function V(){return gi}function W(){}function j(t){return new a(new D(t))}function D(t){this.array=t}function z(t,e,n){function i(t){n.end(t)}for(var r=0,o=e.length;r<o&&this.active;++r)n.event(t,e[r]);this.active&&i(t)}function O(t){return"function"==typeof t[bi]}function F(t){return t[bi]()}function G(t){return new a(new H(t))}function H(t){this.iterable=t}function J(t,e,n){this.scheduler=n,this.iterator=t,this.task=new T(K,this,e),n.asap(this.task)}function K(t,e,n){var i=e.iterator.next();i.done?n.end(t,i.value):n.event(t,i.value),e.scheduler.asap(e.task)}function Q(t){if(t instanceof a)return t;if(Array.isArray(t)||c(t))return j(t);if(O(t))return G(t);throw new TypeError("from(x) must be observable, iterable, or array-like: "+t)}function U(t){return new a(new xi(t))}function X(t,e,n){try{n.event(t,e)}catch(e){n.error(t,e)}}function Y(t,e,n){try{n.end(t,e)}catch(e){n.error(t,e)}}function Z(t,e,n){this.event=t,this.source=e,this.capture=n}function $(t){var e=t.target;e.source.removeEventListener(e.event,t.addEvent,e.capture)}function tt(t){return Promise.resolve(t).then(et)}function et(t){try{return t.run()}catch(e){return t.error(e)}}function nt(t){this.sink=t,this.events=[],this.active=!0}function it(t,e,n){this.sink=t,this.events=n,this.time=e}function rt(t,e,n){this.time=t,this.value=e,this.sink=n}function ot(t,e,n){this.time=t,this.value=e,this.sink=n}function st(t,e){this.event=t,this.source=e}function ut(t){var e=t.target;e.source.removeListener(e.event,t.addEvent)}function ht(t,e,n){var i;if("function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener)arguments.length<3&&(n=!1),i=new Z(t,e,n);else{if("function"!=typeof e.addListener||"function"!=typeof e.removeListener)throw new Error("source must support addEventListener/removeEventListener or addListener/removeListener");i=new st(t,e)}return new a(i)}function ct(t,e,n,i){this.time=t,this.period=e,this.task=n,this.scheduler=i,this.active=!0}function pt(t,e){this.timer=t,this.timeline=e,this._timer=null,this._nextArrival=1/0;var n=this;this._runReadyTasksBound=function(){n._runReadyTasks(n.now())}}function ft(){}function at(t){this.f=t,this.active=!0}function dt(t){var e=new at(t);return tt(e),e}function vt(){this.tasks=[]}function lt(t,e,n){for(var i=e.events,r=0;r<i.length;++r){var o=i[r];o.active&&(t(o),o.period>=0&&o.active&&(o.time=o.time+o.period,yt(o,n)))}return n}function yt(t,e){var n=e.length;if(0===n)return void e.push(mt(t.time,[t]));var i=kt(t.time,e);i>=n?e.push(mt(t.time,[t])):t.time===e[i].time?e[i].events.push(t):e.splice(i,0,mt(t.time,[t]))}function wt(t,e){e.events=u(t,e.events)}function kt(t,e){for(var n,i,r=0,o=e.length;r<o;){if(n=Math.floor((r+o)/2),i=e[n],t===i.time)return n;t<i.time?o=n:r=n+1}return o}function mt(t,e){return{time:t,events:e}}function _t(t){return gt(t,Ai)}function gt(t,e){return new Promise(function(n,i){bt(t,e,n,i)})}function bt(t,e,n,i){var r=b(),o=new xt(n,i,r);r.setDisposable(t.run(o,e))}function xt(t,e,n){this._end=t,this._error=e,this._disposable=n,this.active=!0}function At(t,e,n,i){Promise.resolve(n.dispose()).then(function(){t(i)},e)}function Et(t){this.sink=t}function Pt(t,e){this.p=t,this.source=e}function Tt(t,e){this.p=t,this.sink=e}function It(t,e){return function(n){return t(n)&&e(n)}}function Ct(t,e,n){this.p=t,this.f=e,this.source=n}function Mt(t,e,n){this.p=t,this.f=e,this.sink=n}function Lt(t,e){this.f=t,this.source=e}function Rt(t,e){this.f=t,this.sink=e}function qt(t,e){return new a(Lt.create(t,e.source))}function Nt(t,e){return qt(function(){return t},e)}function Bt(t,e){return new a(new St(t,e.source))}function St(t,e){this.source=e,this.f=t}function Vt(t,e){this.sink=e,this.f=t}function Wt(t,e){return jt(Bt(t,e))}function jt(t){return _t(t.source)}function Dt(t,e,n){return new a(new zt(t,e,n.source))}function zt(t,e,n){this.step=t,this.seed=e,this.source=n}function Ot(t,e,n){this.step=t,this.seed=e,this.sink=n}function Ft(t,e,n){return new a(new Gt(t,e,n.source))}function Gt(t,e,n){this.source=n,this.f=t,this.value=e}function Ht(t,e,n){this.f=t,this.value=e,this.sink=n}function Jt(t,e,n){return _t(new Kt(t,e,n.source))}function Kt(t,e,n){this.source=n,this.f=t,this.value=e}function Qt(t,e,n){this.f=t,this.value=e,this.sink=n}function Ut(t,e){return new a(new Xt(t,e))}function Xt(t,e){this.f=t,this.value=e}function Yt(t,e,n,i){function r(t){s.sink.error(s.scheduler.now(),t)}function o(t){return Zt(t,e)}this.f=t,this.sink=n,this.scheduler=i,this.active=!0;var s=this;Promise.resolve(this).then(o).catch(r)}function Zt(t,e){var n=t.f;return Promise.resolve(n(e)).then(function(e){return $t(t,e)})}function $t(t,e){return e.done?(t.sink.end(t.scheduler.now(),e.value),e.value):(t.sink.event(t.scheduler.now(),e.value),t.active?Zt(t,e.seed):e.value)}function te(t,e){return new a(new ee(t,e))}function ee(t,e){this.f=t,this.value=e}function ne(t,e,n,i){function r(t){u.sink.error(u.scheduler.now(),t)}function o(t){return ie(t,s)}this.f=t,this.sink=n,this.scheduler=i,this.active=!0;var s=e,u=this;Promise.resolve(this).then(o).catch(r)}function ie(t,e){if(t.sink.event(t.scheduler.now(),e),!t.active)return e;var n=t.f;return Promise.resolve(n(e)).then(function(e){return re(t,e)})}function re(t,e){return t.active?ie(t,e):t.value}function oe(t){return new a(new se(t,i(arguments)))}function se(t,e){this.f=t,this.args=e}function ue(t,e,n){function i(t){r.sink.error(r.scheduler.now(),t)}this.iterator=t,this.sink=e,this.scheduler=n,this.active=!0;var r=this;Promise.resolve(this).then(he).catch(i)}function he(t,e){return t.active?ce(t,t.iterator.next(e)):e}function ce(t,e){return e.done?t.sink.end(t.scheduler.now(),e.value):Promise.resolve(e.value).then(function(e){return pe(t,e)},function(e){return fe(t,e)})}function pe(t,e){return t.sink.event(t.scheduler.now(),e),he(t,e)}function fe(t,e){return ce(t,t.iterator.throw(e))}function ae(t,e){return new a(new de(t,e.source))}function de(t,e){this.f=t,this.source=e}function ve(t,e,n,i){this.f=t,this.sink=n,this.scheduler=i,this.active=!0,this.disposable=x(e.run(this,i))}function le(t,e){return ye(L(t),e)}function ye(t,e){return ae(function(){return e},t)}function we(t,e){this.sink=e,this.index=t,this.active=!0,this.value=void 0}function ke(t,e){switch(e.length){case 0:return t();case 1:return t(e[0]);case 2:return t(e[0],e[1]);case 3:return t(e[0],e[1],e[2]);case 4:return t(e[0],e[1],e[2],e[3]);case 5:return t(e[0],e[1],e[2],e[3],e[4]);default:return t.apply(void 0,e)}}function me(t){return _e(t,Pi(arguments))}function _e(t,e){var n=e.length;return 0===n?N():1===n?qt(t,e[0]):new a(ge(t,e))}function ge(t,e){return new xe(t,Ei(be,e))}function be(t){return t.source}function xe(t,e){this.f=t,this.sources=e}function Ae(t,e,n,i){var r=this;this.sink=n,this.disposables=t,this.sinks=e,this.f=i;var o=e.length;this.awaiting=o,this.values=new Array(o),this.hasValue=new Array(o);for(var s=0;s<o;++s)r.hasValue[s]=!1;this.activeCount=e.length}function Ee(t,e){return me(wi,t,e)}function Pe(){this.head=null,this.length=0}function Te(t,e){return Ie(li,t,e)}function Ie(t,e,n){return new a(new Ce(t,e,n.source))}function Ce(t,e,n){this.f=t,this.concurrency=e,this.source=n}function Me(t,e,n,i,r){this.f=t,this.concurrency=e,this.sink=i,this.scheduler=r,this.pending=[],this.current=new Pe,this.disposable=x(n.run(this,r)),this.active=!0}function Le(t,e,n,i){return t(e).source.run(n,i)}function Re(t,e,n){this.prev=this.next=null,this.time=t,this.outer=e,this.sink=n,this.disposable=void 0}function qe(t,e){return Ie(t,1/0,e)}function Ne(t){return Te(1/0,t)}function Be(t,e){return Ie(t,1,e)}function Se(){return Ve(Ti(arguments))}function Ve(t){var e=t.length;return 0===e?N():1===e?t[0]:new a(We(t))}function We(t){return new De(Ii(je,[],t))}function je(t,e){var n=e.source;return n instanceof De?t.concat(n.sources):t.concat(n)}function De(t){this.sources=t}function ze(t,e,n){this.sink=n,this.disposables=t,this.activeCount=e.length}function Oe(t,n){return Ge(t,n,e(2,arguments))}function Fe(t,e){return new a(new Je(li,t.source,[e.source]))}function Ge(t,e,n){return new a(new Je(t,e.source,o(He,n)))}function He(t){return t.source}function Je(t,e,n){this.f=t,this.sampler=e,this.sources=n}function Ke(t){this.sink=t,this.hasValue=!1}function Qe(t,e,n){this.f=t,this.sinks=e,this.sink=n,this.active=!1}function Ue(t){return t.hasValue}function Xe(t){return t.value}function Ye(t){this._capacity=t||32,this._length=0,this._head=0}function Ze(t,e,n,i,r){for(var o=0;o<r;++o)n[o+i]=t[o+e],t[o+e]=void 0}function $e(t){return tn(t,Mi(arguments))}function tn(t,e){return 0===e.length?N():1===e.length?qt(t,e[0]):new a(new nn(t,Ci(en,e)))}function en(t){return t.source}function nn(t,e){this.f=t,this.sources=e}function rn(t,e,n,i){this.f=t,this.sinks=n,this.sink=i,this.buffers=e}function on(t,e,n,i){i.event(e,ke(t,Ci(sn,n)))}function sn(t){return t.shift()}function un(t,e){for(var n=0,i=t.length;n<i;++n)if(t[n].isEmpty()&&!e[n].active)return!0;return!1}function hn(t){for(var e=0,n=t.length;e<n;++e)if(t[e].isEmpty())return!1;return!0}function cn(t){return new a(new pn(t.source))}function pn(t){this.source=t}function fn(t,e){this.sink=t,this.scheduler=e,this.current=null,this.ended=!1}function an(t,e,n,i){this.min=t,this.max=e,this.outer=n,this.sink=i,this.disposable=k()}function dn(t,e){return new a(Pt.create(t,e.source))}function vn(t){return ln(kn,t)}function ln(t,e){return new a(new yn(t,e.source))}function yn(t,e){this.equals=t,this.source=e}function wn(t,e){this.equals=t,this.sink=e,this.value=void 0,this.init=!0}function kn(t,e){return t===e}function mn(t,e){return gn(0,t,e)}function _n(t,e){return gn(t,1/0,e)}function gn(t,e,n){return e<=t?N():new a(bn(t,e,n.source))}function bn(t,e,n){return n instanceof Lt?xn(t,e,n):n instanceof En?An(t,e,n):new En(t,e,n)}function xn(t,e,n){return Lt.create(n.f,bn(t,e,n.source))}function An(t,e,n){return t+=n.min,e=Math.min(e+n.min,n.max),new En(t,e,n.source)}function En(t,e,n){this.source=n,this.min=t,this.max=e}function Pn(t,e,n,i,r){this.sink=i,this.skip=t,this.take=e,this.disposable=x(n.run(this,r))}function Tn(t,e){return new a(new In(t,e.source))}function In(t,e){this.p=t,this.source=e}function Cn(t,e,n,i){this.p=t,this.sink=n,this.active=!0,this.disposable=x(e.run(this,i))}function Mn(t,e){return new a(new Ln(t,e.source))}function Ln(t,e){this.p=t,this.source=e}function Rn(t,e){this.p=t,this.sink=e,this.skipping=!0}function qn(t,e){return new a(new Sn(t.source,e.source))}function Nn(t,e){return new a(new Vn(t.source,e.source))}function Bn(t,e){return qn(Ne(t),Nn(t,e))}function Sn(t,e){this.maxSignal=t,this.source=e}function Vn(t,e){this.minSignal=t,this.source=e}function Wn(t,e){this.value=t,this.sink=e}function jn(t,e,n){this.min=t,this.max=e,this.sink=n}function Dn(t,e,n){this.value=1/0,this.sink=e,this.disposable=t.run(this,n)}function zn(t,e,n){this.value=1/0,this.sink=e,this.disposable=t.run(this,n)}function On(){}function Fn(t,e){return t<=0?e:new a(new Gn(t,e.source))}function Gn(t,e){this.dt=t,this.source=e}function Hn(t,e,n){this.dt=t,this.sink=e,this.scheduler=n}function Jn(t){return new a(new Kn(t.source))}function Kn(t){this.source=t}function Qn(t){this.sink=t}function Un(t,e){return new a(Xn(t,e.source))}function Xn(t,e){return e instanceof Lt?Yn(t,e):e instanceof $n?Zn(t,e):new $n(t,e)}function Yn(t,e){return Lt.create(e.f,Xn(t,e.source))}function Zn(t,e){return new $n(Math.max(t,e.period),e.source)}function $n(t,e){this.period=t,this.source=e}function ti(t,e){this.time=0,this.period=t,this.sink=e}function ei(t,e){return new a(new ni(t,e.source))}function ni(t,e){this.dt=t,this.source=e}function ii(t,e,n,i){this.dt=t,this.sink=n,this.scheduler=i,this.value=void 0,this.timer=null;var r=e.run(this,i);this.disposable=m([this,r])}function ri(t){return oi(L(t))}function oi(t){return new a(new si(t.source))}function si(t){this.source=t}function ui(t,e){this.sink=t,this.scheduler=e,this.queue=Promise.resolve();var n=this;this._eventBound=function(t){n.sink.event(n.scheduler.now(),t)},this._endBound=function(t){n.sink.end(n.scheduler.now(),t)},this._errorBound=function(t){n.sink.error(n.scheduler.now(),t)}}function hi(t){this.sink=t,this.active=!0}function ci(t,e){return new a(new di(t,e.source))}function pi(t){return new a(new fi(t))}function fi(t){this.value=t}function ai(t,e,n){n.error(t,e)}function di(t,e){this.f=t,this.source=e}function vi(t,e,n,i){this.f=t,this.sink=new hi(n),this.scheduler=i,this.disposable=e.run(this,i)}var li=function(t){return t},yi=function(t,e){return function(n){return t(e(n))}},wi=function(t,e){return t(e)};d.prototype.dispose=function(){return this._dispose(this._data)},v.prototype.setDisposable=function(t){if(void 0!==this.disposable)throw new Error("setDisposable called more than once");this.disposable=t,this.disposed&&this._resolve(t.dispose())},v.prototype.dispose=function(){return this.disposed?this.result:(this.disposed=!0,void 0!==this.disposable&&(this.result=this.disposable.dispose()),this.result)};var ki=o,mi=li;T.event=function(t,e){return new T(C,t,e)},T.end=function(t,e){return new T(M,t,e)},T.error=function(t,e){return new T(I,t,e)},T.prototype.dispose=function(){this.active=!1},T.prototype.run=function(t){this.active&&this._run(t,this.value,this.sink)},T.prototype.error=function(t,e){return this.active?void this.sink.error(t,e):P(e)},R.prototype.run=function(t,e){return e.asap(new T(q,this.value,t))},B.prototype.run=function(t,e){var n=T.end(void 0,t);return e.asap(n),w(S,n)};var _i=new a(new B);W.prototype.run=function(){return k()};var gi=new a(new W);D.prototype.run=function(t,e){return e.asap(new T(z,this.array,t))};var bi;bi="function"==typeof Set&&"function"==typeof(new Set)["@@iterator"]?"@@iterator":"function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_",H.prototype.run=function(t,e){return new J(F(this.iterable),t,e)},J.prototype.dispose=function(){return this.task.dispose()};var xi=function(t){this.period=t};xi.prototype.run=function(t,e){return e.periodic(this.period,T.event(void 0,t))},Z.prototype.run=function(t,e){function n(n){X(e.now(),n,t)}return this.source.addEventListener(this.event,n,this.capture),w($,{target:this,addEvent:n})},nt.prototype.event=function(t,e){this.active&&(0===this.events.length&&tt(new it(this.sink,t,this.events)),this.events.push({time:t,value:e}))},nt.prototype.end=function(t,e){this.active&&this._end(new rt(t,e,this.sink))},nt.prototype.error=function(t,e){this._end(new ot(t,e,this.sink))},nt.prototype._end=function(t){this.active=!1,tt(t)},it.prototype.run=function(){for(var t,e=this,n=this.events,i=this.sink,r=0,o=n.length;r<o;++r)t=n[r],e.time=t.time,i.event(t.time,t.value);n.length=0},it.prototype.error=function(t){this.sink.error(this.time,t)},rt.prototype.run=function(){this.sink.end(this.time,this.value)},rt.prototype.error=function(t){this.sink.error(this.time,t)},ot.prototype.run=function(){this.sink.error(this.time,this.value)},ot.prototype.error=function(t){throw t},st.prototype.run=function(t,e){function n(t){var n=arguments,r=arguments.length;if(r>1){for(var o=new Array(r),s=0;s<r;++s)o[s]=n[s];X(e.now(),o,i)}else X(e.now(),t,i)}var i=new nt(t);return this.source.addListener(this.event,n),w(ut,{target:this,addEvent:n})},ct.prototype.run=function(){return this.task.run(this.time)},ct.prototype.error=function(t){return this.task.error(this.time,t)},ct.prototype.dispose=function(){return this.scheduler.cancel(this),this.task.dispose()},pt.prototype.now=function(){return this.timer.now()},pt.prototype.asap=function(t){return this.schedule(0,-1,t)},pt.prototype.delay=function(t,e){return this.schedule(t,-1,e)},pt.prototype.periodic=function(t,e){return this.schedule(0,t,e)},pt.prototype.schedule=function(t,e,n){var i=this.now(),r=new ct(i+Math.max(0,t),e,n,this);return this.timeline.add(r),this._scheduleNextRun(i),r},pt.prototype.cancel=function(t){t.active=!1,this.timeline.remove(t)&&this._reschedule()},pt.prototype.cancelAll=function(t){this.timeline.removeAll(t),this._reschedule()},pt.prototype._reschedule=function(){this.timeline.isEmpty()?this._unschedule():this._scheduleNextRun(this.now())},pt.prototype._unschedule=function(){this.timer.clearTimer(this._timer),this._timer=null},pt.prototype._scheduleNextRun=function(t){if(!this.timeline.isEmpty()){var e=this.timeline.nextArrival();null===this._timer?this._scheduleNextArrival(e,t):e<this._nextArrival&&(this._unschedule(),this._scheduleNextArrival(e,t))}},pt.prototype._scheduleNextArrival=function(t,e){this._nextArrival=t;var n=Math.max(0,t-e);this._timer=this.timer.setTimer(this._runReadyTasksBound,n)},pt.prototype._runReadyTasks=function(t){this._timer=null,this.timeline.runTasks(t,et),this._scheduleNextRun(this.now())},ft.prototype.now=Date.now,ft.prototype.setTimer=function(t,e){return e<=0?dt(t):setTimeout(t,e)},ft.prototype.clearTimer=function(t){return t instanceof at?t.cancel():clearTimeout(t)},at.prototype.run=function(){return this.active&&this.f()},at.prototype.error=function(t){throw t},at.prototype.cancel=function(){this.active=!1},vt.prototype.nextArrival=function(){return this.isEmpty()?1/0:this.tasks[0].time},vt.prototype.isEmpty=function(){return 0===this.tasks.length},vt.prototype.add=function(t){yt(t,this.tasks)},vt.prototype.remove=function(t){var e=kt(t.time,this.tasks);if(e>=0&&e<this.tasks.length){var n=h(t,this.tasks[e].events);if(n>=0)return this.tasks[e].events.splice(n,1),!0}return!1},vt.prototype.removeAll=function(t){for(var e=this,n=0,i=this.tasks.length;n<i;++n)wt(t,e.tasks[n])},vt.prototype.runTasks=function(t,e){for(var n=this,i=this.tasks,r=i.length,o=0;o<r&&i[o].time<=t;)++o;this.tasks=i.slice(o);for(var s=0;s<o;++s)n.tasks=lt(e,i[s],n.tasks)};var Ai=new pt(new ft,new vt);xt.prototype.event=function(t,e){},xt.prototype.end=function(t,e){this.active&&(this.active=!1,At(this._end,this._error,this._disposable,e))},xt.prototype.error=function(t,e){this.active=!1,At(this._error,this._error,this._disposable,e)},Et.prototype.event=function(t,e){return this.sink.event(t,e)},Et.prototype.end=function(t,e){return this.sink.end(t,e)},Et.prototype.error=function(t,e){return this.sink.error(t,e)},Pt.create=function(t,e){return e instanceof Pt?new Pt(It(e.p,t),e.source):new Pt(t,e)},Pt.prototype.run=function(t,e){return this.source.run(new Tt(this.p,t),e)},Tt.prototype.end=Et.prototype.end,Tt.prototype.error=Et.prototype.error,Tt.prototype.event=function(t,e){var n=this.p;n(e)&&this.sink.event(t,e)},Ct.prototype.run=function(t,e){return this.source.run(new Mt(this.p,this.f,t),e)},Mt.prototype.event=function(t,e){var n=this.f,i=this.p;i(e)&&this.sink.event(t,n(e))},Mt.prototype.end=Et.prototype.end,Mt.prototype.error=Et.prototype.error,Lt.create=function(t,e){return e instanceof Lt?new Lt(yi(t,e.f),e.source):e instanceof Pt?new Ct(e.p,t,e.source):new Lt(t,e)},Lt.prototype.run=function(t,e){return this.source.run(new Rt(this.f,t),e)},Rt.prototype.end=Et.prototype.end,Rt.prototype.error=Et.prototype.error,Rt.prototype.event=function(t,e){var n=this.f;this.sink.event(t,n(e))},St.prototype.run=function(t,e){return this.source.run(new Vt(this.f,t),e)},Vt.prototype.end=Et.prototype.end,Vt.prototype.error=Et.prototype.error,Vt.prototype.event=function(t,e){var n=this.f;n(e),this.sink.event(t,e)},zt.prototype.run=function(t,e){return this.source.run(new Ot(this.step,this.seed,t),e)},Ot.prototype.error=Et.prototype.error,Ot.prototype.event=function(t,e){var n=this.step(this.seed,e);this.seed=n.seed,this.sink.event(t,n.value)},Ot.prototype.end=function(t){this.sink.end(t,this.seed)},Gt.prototype.run=function(t,e){var n=e.asap(T.event(this.value,t)),i=this.source.run(new Ht(this.f,this.value,t),e);return m([n,i])},Ht.prototype.event=function(t,e){var n=this.f;this.value=n(this.value,e),this.sink.event(t,this.value)},Ht.prototype.error=Et.prototype.error,Ht.prototype.end=Et.prototype.end,Kt.prototype.run=function(t,e){return this.source.run(new Qt(this.f,this.value,t),e)},Qt.prototype.event=function(t,e){var n=this.f;this.value=n(this.value,e),this.sink.event(t,this.value)},Qt.prototype.error=Et.prototype.error,Qt.prototype.end=function(t){this.sink.end(t,this.value)},Xt.prototype.run=function(t,e){return new Yt(this.f,this.value,t,e)},Yt.prototype.dispose=function(){this.active=!1},ee.prototype.run=function(t,e){return new ne(this.f,this.value,t,e)},ne.prototype.dispose=function(){this.active=!1},se.prototype.run=function(t,e){return new ue(this.f.apply(void 0,this.args),t,e)},ue.prototype.dispose=function(){this.active=!1},de.prototype.run=function(t,e){return new ve(this.f,this.source,t,e)},ve.prototype.error=Et.prototype.error,ve.prototype.event=function(t,e){this.active&&this.sink.event(t,e)},ve.prototype.end=function(t,e){this.active&&(y(t,this.disposable,this.sink),this._startNext(t,e,this.sink))},ve.prototype._startNext=function(t,e,n){try{this.disposable=this._continue(this.f,e,n)}catch(e){n.error(t,e)}},ve.prototype._continue=function(t,e,n){return t(e).source.run(n,this.scheduler)},ve.prototype.dispose=function(){return this.active=!1,this.disposable.dispose()},we.prototype.event=function(t,e){this.active&&(this.value=e,this.sink.event(t,this))},we.prototype.end=function(t,e){this.active&&(this.active=!1,this.sink.end(t,{index:this.index,value:e}))},we.prototype.error=Et.prototype.error;var Ei=o,Pi=i;xe.prototype.run=function(t,e){for(var n,i=this,r=this.sources.length,o=new Array(r),s=new Array(r),u=new Ae(o,s,t,this.f),h=0;h<r;++h)n=s[h]=new we(h,u),o[h]=i.sources[h].run(n,e);return m(o)},Ae.prototype.error=Et.prototype.error,Ae.prototype.event=function(t,e){var n=e.index,i=this._updateReady(n);this.values[n]=e.value,0===i&&this.sink.event(t,ke(this.f,this.values))},Ae.prototype._updateReady=function(t){return this.awaiting>0&&(this.hasValue[t]||(this.hasValue[t]=!0,this.awaiting-=1)),this.awaiting},Ae.prototype.end=function(t,e){y(t,this.disposables[e.index],this.sink),0===--this.activeCount&&this.sink.end(t,e.value)},Pe.prototype.add=function(t){null!==this.head&&(this.head.prev=t,t.next=this.head),this.head=t,++this.length},Pe.prototype.remove=function(t){--this.length,t===this.head&&(this.head=this.head.next),null!==t.next&&(t.next.prev=t.prev,t.next=null),null!==t.prev&&(t.prev.next=t.next,t.prev=null)},Pe.prototype.isEmpty=function(){return 0===this.length},Pe.prototype.dispose=function(){if(this.isEmpty())return Promise.resolve();var t=[],e=this.head;for(this.head=null,this.length=0;null!==e;)t.push(e.dispose()),e=e.next;return Promise.all(t)},Ce.prototype.run=function(t,e){return new Me(this.f,this.concurrency,this.source,t,e)},Me.prototype.event=function(t,e){this._addInner(t,e)},Me.prototype._addInner=function(t,e){this.current.length<this.concurrency?this._startInner(t,e):this.pending.push(e)},Me.prototype._startInner=function(t,e){try{this._initInner(t,e)}catch(e){this.error(t,e)}},Me.prototype._initInner=function(t,e){var n=new Re(t,this,this.sink);n.disposable=Le(this.f,e,n,this.scheduler),this.current.add(n)},Me.prototype.end=function(t,e){this.active=!1,y(t,this.disposable,this.sink),this._checkEnd(t,e)},Me.prototype.error=function(t,e){this.active=!1,this.sink.error(t,e)},Me.prototype.dispose=function(){return this.active=!1,this.pending.length=0,Promise.all([this.disposable.dispose(),this.current.dispose()])},Me.prototype._endInner=function(t,e,n){this.current.remove(n),y(t,n,this),0===this.pending.length?this._checkEnd(t,e):this._startInner(t,this.pending.shift())},Me.prototype._checkEnd=function(t,e){!this.active&&this.current.isEmpty()&&this.sink.end(t,e)},Re.prototype.event=function(t,e){this.sink.event(Math.max(t,this.time),e)},Re.prototype.end=function(t,e){this.outer._endInner(Math.max(t,this.time),e,this)},Re.prototype.error=function(t,e){this.outer.error(Math.max(t,this.time),e)},Re.prototype.dispose=function(){return this.disposable.dispose()};var Ti=r,Ii=s;De.prototype.run=function(t,e){for(var n,i=this,r=this.sources.length,o=new Array(r),s=new Array(r),u=new ze(o,s,t),h=0;h<r;++h)n=s[h]=new we(h,u),o[h]=i.sources[h].run(n,e);return m(o)},ze.prototype.error=Et.prototype.error,ze.prototype.event=function(t,e){this.sink.event(t,e.value)},ze.prototype.end=function(t,e){y(t,this.disposables[e.index],this.sink),0===--this.activeCount&&this.sink.end(t,e.value)},Je.prototype.run=function(t,e){for(var n,i=this,r=this.sources.length,o=new Array(r+1),s=new Array(r),u=new Qe(this.f,s,t),h=0;h<r;++h)n=s[h]=new Ke(u),o[h]=i.sources[h].run(n,e);return o[h]=this.sampler.run(u,e),m(o)},Ke.prototype.event=function(t,e){this.value=e,this.hasValue=!0,this.sink._notify(this)},Ke.prototype.end=function(){},Ke.prototype.error=Et.prototype.error,Qe.prototype._notify=function(){this.active||(this.active=this.sinks.every(Ue))},Qe.prototype.event=function(t){this.active&&this.sink.event(t,ke(this.f,o(Xe,this.sinks)))},Qe.prototype.end=Et.prototype.end,Qe.prototype.error=Et.prototype.error,Ye.prototype.push=function(t){var e=this._length;this._checkCapacity(e+1);var n=this._head+e&this._capacity-1;this[n]=t,this._length=e+1},Ye.prototype.shift=function(){var t=this._head,e=this[t];return this[t]=void 0,this._head=t+1&this._capacity-1,this._length--,e},Ye.prototype.isEmpty=function(){return 0===this._length},Ye.prototype.length=function(){return this._length},Ye.prototype._checkCapacity=function(t){this._capacity<t&&this._ensureCapacity(this._capacity<<1)},Ye.prototype._ensureCapacity=function(t){var e=this._capacity;this._capacity=t;var n=this._head+this._length;n>e&&Ze(this,0,this,e,n&e-1)};var Ci=o,Mi=i;nn.prototype.run=function(t,e){for(var n,i=this,r=this.sources.length,o=new Array(r),s=new Array(r),u=new Array(r),h=new rn(this.f,u,s,t),c=0;c<r;++c)u[c]=new Ye,n=s[c]=new we(c,h),o[c]=i.sources[c].run(n,e);return m(o)},rn.prototype.event=function(t,e){var n=this.buffers,i=n[e.index];if(i.push(e.value),1===i.length()){if(!hn(this.buffers))return;on(this.f,t,n,this.sink),un(this.buffers,this.sinks)&&this.sink.end(t,void 0)}},rn.prototype.end=function(t,e){var n=this.buffers[e.index];n.isEmpty()&&this.sink.end(t,e.value)},rn.prototype.error=Et.prototype.error,pn.prototype.run=function(t,e){var n=new fn(t,e);return m([n,this.source.run(n,e)])},fn.prototype.event=function(t,e){this._disposeCurrent(t),this.current=new an(t,1/0,this,this.sink),this.current.disposable=e.source.run(this.current,this.scheduler)},fn.prototype.end=function(t,e){this.ended=!0,this._checkEnd(t,e)},fn.prototype.error=function(t,e){this.ended=!0,this.sink.error(t,e)},fn.prototype.dispose=function(){return this._disposeCurrent(this.scheduler.now())},fn.prototype._disposeCurrent=function(t){if(null!==this.current)return this.current._dispose(t)},fn.prototype._disposeInner=function(t,e){e._dispose(t),e===this.current&&(this.current=null)},fn.prototype._checkEnd=function(t,e){this.ended&&null===this.current&&this.sink.end(t,e)},fn.prototype._endInner=function(t,e,n){this._disposeInner(t,n),this._checkEnd(t,e)},fn.prototype._errorInner=function(t,e,n){this._disposeInner(t,n),this.sink.error(t,e)},an.prototype.event=function(t,e){t<this.max&&this.sink.event(Math.max(t,this.min),e)},an.prototype.end=function(t,e){this.outer._endInner(Math.max(t,this.min),e,this)},an.prototype.error=function(t,e){this.outer._errorInner(Math.max(t,this.min),e,this)},an.prototype._dispose=function(t){this.max=t,y(t,this.disposable,this.sink)},yn.prototype.run=function(t,e){return this.source.run(new wn(this.equals,t),e)},wn.prototype.end=Et.prototype.end,wn.prototype.error=Et.prototype.error,wn.prototype.event=function(t,e){this.init?(this.init=!1,this.value=e,this.sink.event(t,e)):this.equals(this.value,e)||(this.value=e,this.sink.event(t,e))},En.prototype.run=function(t,e){return new Pn(this.min,this.max-this.min,this.source,t,e)},Pn.prototype.end=Et.prototype.end,Pn.prototype.error=Et.prototype.error,Pn.prototype.event=function(t,e){return this.skip>0?void(this.skip-=1):void(0!==this.take&&(this.take-=1,this.sink.event(t,e),0===this.take&&(this.dispose(),this.sink.end(t,e))))},Pn.prototype.dispose=function(){return this.disposable.dispose()},In.prototype.run=function(t,e){return new Cn(this.p,this.source,t,e)},Cn.prototype.end=Et.prototype.end,Cn.prototype.error=Et.prototype.error,Cn.prototype.event=function(t,e){if(this.active){var n=this.p;this.active=n(e),this.active?this.sink.event(t,e):(this.dispose(),this.sink.end(t,e))}},Cn.prototype.dispose=function(){return this.disposable.dispose()},Ln.prototype.run=function(t,e){return this.source.run(new Rn(this.p,t),e)},Rn.prototype.end=Et.prototype.end,Rn.prototype.error=Et.prototype.error,Rn.prototype.event=function(t,e){if(this.skipping){var n=this.p;if(this.skipping=n(e),this.skipping)return}this.sink.event(t,e)},Sn.prototype.run=function(t,e){var n=new Wn(-(1/0),t),i=new zn(this.maxSignal,t,e),r=this.source.run(new jn(n,i,t),e);return m([n,i,r])},Vn.prototype.run=function(t,e){var n=new Dn(this.minSignal,t,e),i=new Wn(1/0,t),r=this.source.run(new jn(n,i,t),e);return m([n,i,r])},Wn.prototype.error=Et.prototype.error,Wn.prototype.event=On,Wn.prototype.end=On,Wn.prototype.dispose=On,jn.prototype.event=function(t,e){t>=this.min.value&&t<this.max.value&&this.sink.event(t,e)},jn.prototype.error=Et.prototype.error,jn.prototype.end=Et.prototype.end,Dn.prototype.event=function(t){t<this.value&&(this.value=t)},Dn.prototype.end=On,Dn.prototype.error=Et.prototype.error,Dn.prototype.dispose=function(){return this.disposable.dispose()},zn.prototype.event=function(t,e){t<this.value&&(this.value=t,this.sink.end(t,e))},zn.prototype.end=On,zn.prototype.error=Et.prototype.error,zn.prototype.dispose=function(){return this.disposable.dispose();
},Gn.prototype.run=function(t,e){var n=new Hn(this.dt,t,e);return m([n,this.source.run(n,e)])},Hn.prototype.dispose=function(){var t=this;this.scheduler.cancelAll(function(e){return e.sink===t.sink})},Hn.prototype.event=function(t,e){this.scheduler.delay(this.dt,T.event(e,this.sink))},Hn.prototype.end=function(t,e){this.scheduler.delay(this.dt,T.end(e,this.sink))},Hn.prototype.error=Et.prototype.error,Kn.prototype.run=function(t,e){return this.source.run(new Qn(t),e)},Qn.prototype.end=Et.prototype.end,Qn.prototype.error=Et.prototype.error,Qn.prototype.event=function(t,e){this.sink.event(t,{time:t,value:e})},$n.prototype.run=function(t,e){return this.source.run(new ti(this.period,t),e)},ti.prototype.event=function(t,e){t>=this.time&&(this.time=t+this.period,this.sink.event(t,e))},ti.prototype.end=Et.prototype.end,ti.prototype.error=Et.prototype.error,ni.prototype.run=function(t,e){return new ii(this.dt,this.source,t,e)},ii.prototype.event=function(t,e){this._clearTimer(),this.value=e,this.timer=this.scheduler.delay(this.dt,T.event(e,this.sink))},ii.prototype.end=function(t,e){this._clearTimer()&&(this.sink.event(t,this.value),this.value=void 0),this.sink.end(t,e)},ii.prototype.error=function(t,e){this._clearTimer(),this.sink.error(t,e)},ii.prototype.dispose=function(){this._clearTimer()},ii.prototype._clearTimer=function(){return null!==this.timer&&(this.timer.dispose(),this.timer=null,!0)},si.prototype.run=function(t,e){return this.source.run(new ui(t,e),e)},ui.prototype.event=function(t,e){var n=this;this.queue=this.queue.then(function(){return n._event(e)}).catch(this._errorBound)},ui.prototype.end=function(t,e){var n=this;this.queue=this.queue.then(function(){return n._end(e)}).catch(this._errorBound)},ui.prototype.error=function(t,e){var n=this;this.queue=this.queue.then(function(){return n._errorBound(e)}).catch(P)},ui.prototype._event=function(t){return t.then(this._eventBound)},ui.prototype._end=function(t){return Promise.resolve(t).then(this._endBound)},hi.prototype.event=function(t,e){this.active&&this.sink.event(t,e)},hi.prototype.end=function(t,e){this.active&&(this.disable(),this.sink.end(t,e))},hi.prototype.error=function(t,e){this.disable(),this.sink.error(t,e)},hi.prototype.disable=function(){return this.active=!1,this.sink},fi.prototype.run=function(t,e){return e.asap(new T(ai,this.value,t))},di.prototype.run=function(t,e){return new vi(this.f,this.source,t,e)},vi.prototype.event=function(t,e){X(t,e,this.sink)},vi.prototype.end=function(t,e){Y(t,e,this.sink)},vi.prototype.error=function(t,e){var n=this.sink.disable();y(t,this.disposable,this.sink),this._startNext(t,e,n)},vi.prototype._startNext=function(t,e,n){try{this.disposable=this._continue(this.f,e,n)}catch(e){n.error(t,e)}},vi.prototype._continue=function(t,e,n){var i=t(e);return i.source.run(n,this.scheduler)},vi.prototype.dispose=function(){return this.disposable.dispose()};var Li=p(ht),Ri=p(Wt),qi=f(Dt),Ni=f(Ft),Bi=f(Jt),Si=p(Ut),Vi=p(te),Wi=p(ye),ji=p(le),Di=p(qt),zi=p(Nt),Oi=p(Bt),Fi=p(Ee),Gi=p(qe),Hi=p(ae),Ji=p(Be),Ki=p(Te),Qi=f(Ie),Ui=p(_e),Xi=p(Fe),Yi=f(Ge),Zi=p(tn),$i=p(dn),tr=p(ln),er=p(mn),nr=p(_n),ir=f(gn),rr=p(Tn),or=p(Mn),sr=p(qn),ur=p(Nn),hr=p(Bn),cr=p(Fn),pr=p(Un),fr=p(ei),ar=p(ci);t.fromEvent=Li,t.drain=jt,t.observe=Ri,t.loop=qi,t.scan=Ni,t.reduce=Bi,t.unfold=Si,t.iterate=Vi,t.concat=Wi,t.startWith=ji,t.map=Di,t.constant=zi,t.tap=Oi,t.ap=Fi,t.chain=Gi,t.join=Ne,t.continueWith=Hi,t.concatMap=Ji,t.mergeConcurrently=Ki,t.mergeMapConcurrently=Qi,t.combine=me,t.combineArray=Ui,t.sample=Oe,t.sampleWith=Xi,t.sampleArray=Yi,t.zip=$e,t.zipArray=Zi,t.filter=$i,t.skipRepeats=vn,t.skipRepeatsWith=tr,t.take=er,t.skip=nr,t.slice=ir,t.takeWhile=rr,t.skipWhile=or,t.until=sr,t.since=ur,t.during=hr,t.delay=cr,t.throttle=pr,t.debounce=fr,t.recoverWith=ar,t.throwError=pi,t.Stream=a,t.just=L,t.empty=N,t.never=V,t.from=Q,t.periodic=U,t.generate=oe,t.merge=Se,t.mergeArray=Ve,t.switchLatest=cn,t.timestamp=Jn,t.fromPromise=ri,t.awaitPromises=oi,t.defaultScheduler=Ai,t.PropagateTask=T,Object.defineProperty(t,"__esModule",{value:!0})});